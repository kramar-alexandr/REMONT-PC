remote function date GetDateOfSerial(string,string,date); //Edit***************************Sasha2,17:29 18.04.2016SetLangMode(LangRussian,"RUS",0); //**********************************************************************************************************************************************************************global procedure PrintPU_Zebra(record RcVc RepSpec)begin  record PUVc PUr,newPUr;  row PUVc PUrw,newPUrw;  integer wn,i,mtrw,lenth,h,k;  area aLabel;  record INVc INr;  boolean testf;  record ZebraPrinterBlock ZPb;  string 50 printername,price;    SetExportCodePage("CP1251");    blockload(ZPb);    printername = ZPb.PrinterName;    PUr.SerNr = RepSpec.long1;  readfirstmain(PUr,1,true);    recordnew(newPUr);  k=0;  mtrw = MatRowCnt(PUr);    if(RepSpec.flags[0]==1)then begin    if(RepSpec.flags[1]>0 and RepSpec.flags[1]<=mtrw and RepSpec.flags[2]>=RepSpec.flags[1] and RepSpec.flags[2]<=mtrw)then begin      i=RepSpec.flags[1]-1;      mtrw = RepSpec.flags[2];    end else begin      i=0;      mtrw=0;    end;  end;    for (i=i;i<mtrw;i=i+1) begin    testf = true;    MatRowGet(PUr,i,PUrw);    if (nonblank(PUrw.ArtCode)) then begin      INr.Code = PUrw.ArtCode;      If(readfirstmain(INr,1,true)) then begin        If(nonblank(INr.AlternativeCode)) then begin          lenth = len(INr.AlternativeCode);          if(lenth!=5)then begin testf=false; end;          for(h=0;h<lenth;h=h+1) begin            if((mid(INr.AlternativeCode,h,1)<"0") or (mid(INr.AlternativeCode,h,1)>"9")) then begin testf = false; end;          end;        end else begin          testf = false;        end;        if(testf) then begin          matrowget(newPUr,k,newPUrw);          newPUrw.ArtCode = PUrw.ArtCode;          newPUrw.Spec = INr.AlternativeCode;          newPUrw.SerialNr = PUrw.SerialNr;          newPUrw.RetailPrice = PUrw.RetailPrice;          matrowput(newPUr,k,newPUrw);          k=k+1;        end else begin        	if(PUrw.RetailPrice!=0)then begin        		matrowget(newPUr,k,newPUrw);						newPUrw.ArtCode = PUrw.ArtCode;						newPUrw.Spec = INr.AlternativeCode;						newPUrw.SerialNr = "";						newPUrw.RetailPrice = PUrw.RetailPrice;						matrowput(newPUr,k,newPUrw);						k=k+1;	        	end;        end;      end;     end;  end;    if(k>0)then begin            SetAreaZeroSize(aLabel);    if (true) then begin      addtexttoarea("q464" & chr(13) & chr(10),aLabel);      addtexttoarea("Q320,16" & chr(13) & chr(10),aLabel);      addtexttoarea("D10" & chr(13) & chr(10),aLabel);      addtexttoarea("I8,C" & chr(13) & chr(10),aLabel);      addtexttoarea("FK\"1\"" & chr(13) & chr(10),aLabel);      addtexttoarea("FS\"1\"" & chr(13) & chr(10),aLabel);      addtexttoarea("V00,13,N,\"\"" & chr(13) & chr(10),aLabel);      addtexttoarea("V01,5,N,\"\"" & chr(13) & chr(10),aLabel);      addtexttoarea("V02,50,N,\"\"" & chr(13) & chr(10),aLabel);      addtexttoarea("V03,50,N,\"\"" & chr(13) & chr(10),aLabel);      addtexttoarea("V04,50,N,\"\"" & chr(13) & chr(10),aLabel);      addtexttoarea("V05,3,N,\"\"" & chr(13) & chr(10),aLabel);      addtexttoarea("B60,106,0,E30,3,2,50,B,V00" & chr(13) & chr(10),aLabel);      //addtexttoarea("X50,145,5,408,250" & chr(13) & chr(10),aLabel);      addtexttoarea("B115,185,0,1,3,2,30,A,V01" & chr(13) & chr(10),aLabel);      addtexttoarea("A100,245,0,2,1,1,N,V02" & chr(13) & chr(10),aLabel);      addtexttoarea("A100,275,0,4,1,1,N,V03" & chr(13) & chr(10),aLabel);      addtexttoarea("A32,35,0,2,2,2,N,V04" & chr(13) & chr(10),aLabel);      addtexttoarea("PAV05" & chr(13) & chr(10),aLabel);      addtexttoarea("FE" & chr(13) & chr(10),aLabel);      addtexttoarea(chr(13) & chr(10),aLabel);            mtrw = MatRowCnt(newPUr);      for (i=0;i<mtrw;i=i+1) begin        MatRowGet(newPUr,i,newPUrw);        if (nonblank(newPUrw.ArtCode)) then begin          addtexttoarea("FR\"1\"" & chr(13) & chr(10),aLabel);          addtexttoarea("?" & chr(13) & chr(10),aLabel);          addtexttoarea(newPUrw.SerialNr & chr(13) & chr(10),aLabel);          addtexttoarea(newPUrw.Spec & chr(13) & chr(10),aLabel);          addtexttoarea("Alt/Code: " & newPUrw.Spec & chr(13) & chr(10),aLabel);          addtexttoarea("P/N: " & newPUrw.ArtCode & chr(13) & chr(10),aLabel);          price = "цiна:" & ValToString(newPUrw.RetailPrice,M45Val,"",".",0) & " грн.";           //price = convertstringfromcodepage("WINDOWS-1251",price);          addtexttoarea(price & chr(13) & chr(10),aLabel);          addtexttoarea("1" & chr(13) & chr(10),aLabel);          addtexttoarea(chr(13) & chr(10),aLabel);        end;      end;    end else begin      SetAreaZeroSize(aLabel);      addtexttoarea("q464" & chr(13) & chr(10),aLabel);      addtexttoarea("Q320,16" & chr(13) & chr(10),aLabel);      addtexttoarea("D10" & chr(13) & chr(10),aLabel);      addtexttoarea("I8,C" & chr(13) & chr(10),aLabel);      addtexttoarea("FK\"1\"" & chr(13) & chr(10),aLabel);      addtexttoarea("FS\"1\"" & chr(13) & chr(10),aLabel);      addtexttoarea("V00,13,N,\"\"" & chr(13) & chr(10),aLabel);      addtexttoarea("V01,5,N,\"\"" & chr(13) & chr(10),aLabel);      addtexttoarea("V02,50,N,\"\"" & chr(13) & chr(10),aLabel);      addtexttoarea("V03,50,N,\"\"" & chr(13) & chr(10),aLabel);      addtexttoarea("V04,3,N,\"\"" & chr(13) & chr(10),aLabel);      addtexttoarea("B60,26,0,E30,3,2,100,B,V00" & chr(13) & chr(10),aLabel);      addtexttoarea("X50,145,5,408,250" & chr(13) & chr(10),aLabel);      addtexttoarea("B115,155,0,1,3,2,60,A,V01" & chr(13) & chr(10),aLabel);      addtexttoarea("A100,245,0,2,1,1,N,V02" & chr(13) & chr(10),aLabel);      addtexttoarea("A100,275,0,4,1,1,N,V03" & chr(13) & chr(10),aLabel);      addtexttoarea("PAV04" & chr(13) & chr(10),aLabel);      addtexttoarea("FE" & chr(13) & chr(10),aLabel);      addtexttoarea(chr(13) & chr(10),aLabel);            mtrw = MatRowCnt(newPUr);      for (i=0;i<mtrw;i=i+1) begin        MatRowGet(newPUr,i,newPUrw);        if (nonblank(newPUrw.ArtCode)) then begin          addtexttoarea("FR\"1\"" & chr(13) & chr(10),aLabel);          addtexttoarea("?" & chr(13) & chr(10),aLabel);          addtexttoarea(newPUrw.SerialNr & chr(13) & chr(10),aLabel);          addtexttoarea(newPUrw.Spec & chr(13) & chr(10),aLabel);          addtexttoarea("Alt/Code: " & newPUrw.Spec & chr(13) & chr(10),aLabel);          addtexttoarea("P/N: " & newPUrw.ArtCode & chr(13) & chr(10),aLabel);          addtexttoarea("1" & chr(13) & chr(10),aLabel);          addtexttoarea(chr(13) & chr(10),aLabel);        end;      end;    end;      CreateFile("ZebraPrint.epl");    closefile;    WriteAreaToFile(aLabel,"ZebraPrint.epl",0);    millisleep(50);    if (WindowsMode==1) then begin      RunProgram("c:\\windows\\system32\\cmd.exe","/C \"" & "copy " & "ZebraPrint.epl" & " \\\\" & ZPb.ParamStr1 & "\\" & printername & "\"");    end;    if (WindowsMode==0) then begin      RunProgram("/usr/bin/lp","-d " & printername & " -o raw ZebraPrint.epl");    end;  end;  return;end;//**********************************************************************************************************************************************************************global procedure PrintPU_ZebraBig(record RcVc RepSpec)begin  record PUVc PUr,newPUr;  record ItemHistVc IHr;  row PUVc PUrw,newPUrw;  integer wn,i,mtrw,lenth,h,k,j;  area aLabel;  record INVc INr;  boolean testf;  record ZebraPrinterBlock ZPb;  string 50 printername;  //record GigieneTextVc GGr;  //row GigieneTextVc GGrw;  integer qty,jj;    blockload(ZPb);    printername = ZPb.PrinterName;    PUr.SerNr = RepSpec.long1;  readfirstmain(PUr,1,true);    recordnew(newPUr);  k=0;  mtrw = MatRowCnt(PUr);    if(RepSpec.flags[0]==1)then begin    if(RepSpec.flags[1]>0 and RepSpec.flags[1]<=mtrw and RepSpec.flags[2]>=RepSpec.flags[1] and RepSpec.flags[2]<=mtrw)then begin      i=RepSpec.flags[1]-1;      mtrw = RepSpec.flags[2];    end else begin      i=0;      mtrw=0;    end;  end;    for (i=i;i<mtrw;i=i+1) begin    testf = true;    MatRowGet(PUr,i,PUrw);    if (nonblank(PUrw.ArtCode)) then begin      INr.Code = PUrw.ArtCode;      If(readfirstmain(INr,1,true)) then begin        If(nonblank(INr.AlternativeCode)) then begin          lenth = len(INr.AlternativeCode);          if(lenth!=5)then begin testf=false; end;          for(h=0;h<lenth;h=h+1) begin            if((mid(INr.AlternativeCode,h,1)<"0") or (mid(INr.AlternativeCode,h,1)>"9")) then begin testf = false; end;          end;        end else begin          testf = false;        end;        if(testf) then begin          matrowget(newPUr,k,newPUrw);          newPUrw.ArtCode = PUrw.ArtCode;          newPUrw.Spec = INr.AlternativeCode;          newPUrw.SerialNr = PUrw.SerialNr;          For(jj=0;jj<len(PUrw.SerialNr);jj=jj+1) begin	  				if((mid(PUrw.SerialNr,jj,1)<"0") or (mid(PUrw.SerialNr,jj,1)>"9")) then begin PUrw.SerialNr = "000000000000";jj=len(PUrw.SerialNr); end;					end;           if(len(PUrw.SerialNr)!=13)then begin          	newPUrw.SerialNr = "0000000000000";          end;                              newPUrw.Quant = PUrw.Quant;          matrowput(newPUr,k,newPUrw);          k=k+1;        end;      end;     end;  end;    if(k>0)then begin        SetAreaZeroSize(aLabel);    addtexttoarea("q600" & chr(13) & chr(10),aLabel);    addtexttoarea("Q400,32" & chr(13) & chr(10),aLabel);    addtexttoarea("D10" & chr(13) & chr(10),aLabel);    addtexttoarea("S4" & chr(13) & chr(10),aLabel);    addtexttoarea("i0" & chr(13) & chr(10),aLabel);    addtexttoarea("I8,C" & chr(13) & chr(10),aLabel);    addtexttoarea("FK\"1\"" & chr(13) & chr(10),aLabel);    addtexttoarea("FS\"1\"" & chr(13) & chr(10),aLabel);    addtexttoarea("V00,13,N,\"\"" & chr(13) & chr(10),aLabel);    addtexttoarea("V01,5,N,\"\"" & chr(13) & chr(10),aLabel);    addtexttoarea("V02,50,N,\"\"" & chr(13) & chr(10),aLabel);    addtexttoarea("V03,50,N,\"\"" & chr(13) & chr(10),aLabel);    addtexttoarea("V04,4,N,\"\"" & chr(13) & chr(10),aLabel);    addtexttoarea("V05,4,N,\"\"" & chr(13) & chr(10),aLabel);        addtexttoarea("V06,99,N,\"\"" & chr(13) & chr(10),aLabel);    addtexttoarea("V07,99,N,\"\"" & chr(13) & chr(10),aLabel);    addtexttoarea("V08,99,N,\"\"" & chr(13) & chr(10),aLabel);    addtexttoarea("V09,99,N,\"\"" & chr(13) & chr(10),aLabel);    addtexttoarea("V10,99,N,\"\"" & chr(13) & chr(10),aLabel);    addtexttoarea("V11,99,N,\"\"" & chr(13) & chr(10),aLabel);    addtexttoarea("V12,99,N,\"\"" & chr(13) & chr(10),aLabel);    addtexttoarea("V13,99,N,\"\"" & chr(13) & chr(10),aLabel);    addtexttoarea("V14,99,N,\"\"" & chr(13) & chr(10),aLabel);    addtexttoarea("V15,99,N,\"\"" & chr(13) & chr(10),aLabel);    addtexttoarea("V16,99,N,\"\"" & chr(13) & chr(10),aLabel);    addtexttoarea("V17,99,N,\"\"" & chr(13) & chr(10),aLabel);    addtexttoarea("V18,99,N,\"\"" & chr(13) & chr(10),aLabel);    addtexttoarea("V19,99,N,\"\"" & chr(13) & chr(10),aLabel);    addtexttoarea("V20,99,N,\"\"" & chr(13) & chr(10),aLabel);    addtexttoarea("V21,99,N,\"\"" & chr(13) & chr(10),aLabel);    addtexttoarea("V22,99,N,\"\"" & chr(13) & chr(10),aLabel);    addtexttoarea("V23,99,N,\"\"" & chr(13) & chr(10),aLabel);    addtexttoarea("V24,99,N,\"\"" & chr(13) & chr(10),aLabel);    addtexttoarea("V25,99,N,\"\"" & chr(13) & chr(10),aLabel);    addtexttoarea("V26,8,N,\"\"" & chr(13) & chr(10),aLabel); //Edit***************************Sasha2,16:43 26.10.2015    addtexttoarea("V27,99,N,\"\"" & chr(13) & chr(10),aLabel); //Edit***************************Sasha2,16:43 26.10.2015        addtexttoarea("A20,385,3,a,1,1,N,V06" & chr(13) & chr(10),aLabel);    addtexttoarea("A40,385,3,a,1,1,N,V07" & chr(13) & chr(10),aLabel);    addtexttoarea("A60,385,3,a,1,1,N,V08" & chr(13) & chr(10),aLabel);    addtexttoarea("A80,385,3,a,1,1,N,V09" & chr(13) & chr(10),aLabel);    addtexttoarea("A100,385,3,a,1,1,N,V10" & chr(13) & chr(10),aLabel);    addtexttoarea("A120,385,3,a,1,1,N,V11" & chr(13) & chr(10),aLabel);    addtexttoarea("A140,385,3,a,1,1,N,V12" & chr(13) & chr(10),aLabel);    addtexttoarea("A160,385,3,a,1,1,N,V13" & chr(13) & chr(10),aLabel);    addtexttoarea("A180,385,3,a,1,1,N,V14" & chr(13) & chr(10),aLabel);    addtexttoarea("A200,385,3,a,1,1,N,V15" & chr(13) & chr(10),aLabel);    addtexttoarea("A220,385,3,a,1,1,N,V16" & chr(13) & chr(10),aLabel);    addtexttoarea("A240,385,3,a,1,1,N,V17" & chr(13) & chr(10),aLabel);    addtexttoarea("A260,385,3,a,1,1,N,V18" & chr(13) & chr(10),aLabel);    addtexttoarea("A280,385,3,a,1,1,N,V19" & chr(13) & chr(10),aLabel);    addtexttoarea("A300,385,3,a,1,1,N,V20" & chr(13) & chr(10),aLabel);    addtexttoarea("A320,385,3,a,1,1,N,V21" & chr(13) & chr(10),aLabel);    addtexttoarea("A340,385,3,a,1,1,N,V22" & chr(13) & chr(10),aLabel);    addtexttoarea("A360,385,3,a,1,1,N,V23" & chr(13) & chr(10),aLabel);    addtexttoarea("A380,385,3,a,1,1,N,V24" & chr(13) & chr(10),aLabel);    addtexttoarea("A400,385,3,a,1,1,N,V25" & chr(13) & chr(10),aLabel);    addtexttoarea("GG458,20,V26" & chr(13) & chr(10),aLabel); //Edit***************************Sasha2,16:53 26.10.2015    addtexttoarea("A520,67,3,2,1,1,N,V27" & chr(13) & chr(10),aLabel); //Edit***************************Sasha2,17:00 26.10.2015        addtexttoarea("B332,364,3,E30,3,2,100,B,V00" & chr(13) & chr(10),aLabel);    addtexttoarea("X10,2,5,595,395" & chr(13) & chr(10),aLabel);    addtexttoarea("B470,352,3,1,3,2,60,A,V01" & chr(13) & chr(10),aLabel);    addtexttoarea("X454,79,5,546,385" & chr(13) & chr(10),aLabel);    addtexttoarea("A536,365,3,2,1,1,N,V02" & chr(13) & chr(10),aLabel);    addtexttoarea("A560,385,3,4,1,1,N,V03" & chr(13) & chr(10),aLabel);    addtexttoarea("PAV04,V05" & chr(13) & chr(10),aLabel);    addtexttoarea("FE" & chr(13) & chr(10),aLabel);    addtexttoarea(chr(13) & chr(10),aLabel);        mtrw = MatRowCnt(newPUr);    for (i=0;i<mtrw;i=i+1) begin      MatRowGet(newPUr,i,newPUrw);      if (nonblank(newPUrw.ArtCode)) then begin        addtexttoarea("FR\"1\"" & chr(13) & chr(10),aLabel);        addtexttoarea("?" & chr(13) & chr(10),aLabel);        if(newPUrw.SerialNr=="0000000000000")then begin					addtexttoarea("" & chr(13) & chr(10),aLabel);// Edit ************************** Wednesday, 13 January 2016 11:50:00        end else begin        	addtexttoarea(newPUrw.SerialNr & chr(13) & chr(10),aLabel);        end;        addtexttoarea(newPUrw.Spec & chr(13) & chr(10),aLabel);        addtexttoarea("Alt/Code: " & newPUrw.Spec & chr(13) & chr(10),aLabel);        addtexttoarea("P/N:" & newPUrw.ArtCode & chr(13) & chr(10),aLabel);        qty = newPUrw.Quant;        addtexttoarea(qty & chr(13) & chr(10),aLabel);                addtexttoarea(qty & chr(13) & chr(10),aLabel);        INr.Code = newPUrw.ArtCode;        readfirstmain(INr,1,true);        addtexttoarea(left(INr.GigieneText1,50) & chr(13) & chr(10),aLabel);// Edit ************************** Friday, 17 October 2014 10:59:23        addtexttoarea(left(INr.GigieneText2,50) & chr(13) & chr(10),aLabel);// Edit ************************** Friday, 17 October 2014 10:59:23        addtexttoarea(left(INr.GigieneText3,50) & chr(13) & chr(10),aLabel);// Edit ************************** Friday, 17 October 2014 10:59:24        addtexttoarea(left(INr.GigieneText4,50) & chr(13) & chr(10),aLabel);// Edit ************************** Friday, 17 October 2014 10:59:24        addtexttoarea(left(INr.GigieneText5,50) & chr(13) & chr(10),aLabel);// Edit ************************** Friday, 17 October 2014 10:59:25        addtexttoarea(left(INr.GigieneText6,50) & chr(13) & chr(10),aLabel);// Edit ************************** Friday, 17 October 2014 10:59:25        addtexttoarea(left(INr.GigieneText7,50) & chr(13) & chr(10),aLabel);// Edit ************************** Friday, 17 October 2014 10:59:25        addtexttoarea(left(INr.GigieneText8,50) & chr(13) & chr(10),aLabel);// Edit ************************** Friday, 17 October 2014 10:59:26        addtexttoarea(left(INr.GigieneText9,50) & chr(13) & chr(10),aLabel);// Edit ************************** Friday, 17 October 2014 10:59:26        addtexttoarea(left(INr.GigieneText10,50) & chr(13) & chr(10),aLabel);// Edit ************************** Friday, 17 October 2014 10:59:27        addtexttoarea(left(INr.GigieneText11,50) & chr(13) & chr(10),aLabel);// Edit ************************** Friday, 17 October 2014 10:59:27        addtexttoarea(left(INr.GigieneText12,50) & chr(13) & chr(10),aLabel);// Edit ************************** Friday, 17 October 2014 10:59:27        addtexttoarea(left(INr.GigieneText13,50) & chr(13) & chr(10),aLabel);// Edit ************************** Friday, 17 October 2014 10:59:28        addtexttoarea(left(INr.GigieneText14,50) & chr(13) & chr(10),aLabel);// Edit ************************** Friday, 17 October 2014 10:59:28        addtexttoarea(left(INr.GigieneText15,50) & chr(13) & chr(10),aLabel);// Edit ************************** Friday, 17 October 2014 10:59:29        addtexttoarea(left(INr.GigieneText16,50) & chr(13) & chr(10),aLabel);// Edit ************************** Friday, 17 October 2014 10:59:29        addtexttoarea(left(INr.GigieneText17,50) & chr(13) & chr(10),aLabel);// Edit ************************** Friday, 17 October 2014 10:59:29        addtexttoarea(left(INr.GigieneText18,50) & chr(13) & chr(10),aLabel);// Edit ************************** Friday, 17 October 2014 10:59:30        addtexttoarea(left(INr.GigieneText19,50) & chr(13) & chr(10),aLabel);// Edit ************************** Friday, 17 October 2014 10:59:30        addtexttoarea(left(INr.GigieneText20,50) & chr(13) & chr(10),aLabel);// Edit ************************** Friday, 17 October 2014 10:59:30                if (nonblank(INr.UserStr1)) then begin          addtexttoarea("TECZNACK" & chr(13) & chr(10),aLabel);          addtexttoarea(INr.UserStr1 & chr(13) & chr(10),aLabel);        end else begin          addtexttoarea("" & chr(13) & chr(10),aLabel);          addtexttoarea("" & chr(13) & chr(10),aLabel);        end;                /*GGr.ArtCode = newPUrw.ArtCode;        if(readfirstmain(GGr,1,true))then begin// Edit ************************** Friday, 17 October 2014 10:59:21          for(j=0;j<20;j=j+1)begin            matrowget(GGr,j,GGrw);            addtexttoarea(GGrw.Str1 & chr(13) & chr(10),aLabel);          end;        end else begin          for(j=0;j<20;j=j+1)begin            addtexttoarea("" & chr(13) & chr(10),aLabel);          end;        end;*/        addtexttoarea(chr(13) & chr(10),aLabel);      end;    end;        CreateFile("ZebraPrint.epl");    closefile;    SetExportCodepage("CP1251");    WriteAreaToFile(aLabel,"ZebraPrint.epl",0);    millisleep(50);    if (WindowsMode==1) then begin      RunProgram("c:\\windows\\system32\\cmd.exe","/C \"" & "copy " & "ZebraPrint.epl" & " \\\\" & ZPb.ParamStr1 & "\\" & printername & "\"");    end;    if (WindowsMode==0) then begin      RunProgram("/usr/bin/lp","-d " & printername & " -o raw ZebraPrint.epl");    end;  end;  return;end;//*********************************OPISANIE*********************************************************************************************************procedure preparetext (var string str)begininteger i,lenth;string 255 res;    res = "";  lenth = len(str);  for(i=0;i<lenth;i=i+1)begin    if(mid(str,i,1)=="\"")then begin res = res & "\\"; end;    res = res & mid(str,i,1);  end;  str = res;return;end;global procedure GigieneTextZebraPrint()begin  integer wn,i,mtrw,lenth,h,k,j;  area aLabel;  boolean testf;  record ZebraPrinterBlock ZPb;  string 50 printername;  //record GigieneTextVc GGr;  //row GigieneTextVc GGrw;  record RcVc RepSpec;  string 255 printtext;  record INVc INr;    blockload(ZPb);      wn = CurWindow;  deselectwindow(wn,true);  GetWindowRecord(wn,RepSpec);    //GGr.ArtCode = RepSpec.f1;  INr.Code = RepSpec.f1;// Edit ************************** Friday, 17 October 2014 11:16:04  //ReadFirstmain(GGr,1,true);  ReadFirstmain(INr,1,true);// Edit ************************** Friday, 17 October 2014 11:16:04  printername = ZPb.PrinterName;  //mtrw = matrowcnt(GGr);        SetAreaZeroSize(aLabel);    addtexttoarea("N" & chr(13) & chr(10),aLabel);    addtexttoarea("q464" & chr(13) & chr(10),aLabel);    addtexttoarea("Q320,16" & chr(13) & chr(10),aLabel);    addtexttoarea("D15" & chr(13) & chr(10),aLabel);    addtexttoarea("I8,C" & chr(13) & chr(10),aLabel);    addtexttoarea("X10,5,5,460,305" & chr(13) & chr(10),aLabel);    //addtexttoarea("A20,18,0,a,1,1,N,\"Article: " & GGr.ArtCode & "\"" & chr(13) & chr(10),aLabel);    addtexttoarea("A20,18,0,a,1,1,N,\"Article: " & INr.Code & "\"" & chr(13) & chr(10),aLabel);// Edit ************************** Friday, 17 October 2014 11:16:44    k=36;        printtext = INr.GigieneText1;    preparetext(printtext);    if(nonblank(printtext))then begin			addtexttoarea("A20," & k &",0,a,1,1,N,\"" & printtext & "\"" & chr(13) & chr(10),aLabel);			k=k+18;		end;		printtext = INr.GigieneText2;    preparetext(printtext);    if(nonblank(printtext))then begin			addtexttoarea("A20," & k &",0,a,1,1,N,\"" & printtext & "\"" & chr(13) & chr(10),aLabel);			k=k+18;		end;		printtext = INr.GigieneText3;    preparetext(printtext);    if(nonblank(printtext))then begin			addtexttoarea("A20," & k &",0,a,1,1,N,\"" & printtext & "\"" & chr(13) & chr(10),aLabel);			k=k+18;		end;		printtext = INr.GigieneText4;    preparetext(printtext);    if(nonblank(printtext))then begin			addtexttoarea("A20," & k &",0,a,1,1,N,\"" & printtext & "\"" & chr(13) & chr(10),aLabel);			k=k+18;		end;		printtext = INr.GigieneText5;    preparetext(printtext);    if(nonblank(printtext))then begin			addtexttoarea("A20," & k &",0,a,1,1,N,\"" & printtext & "\"" & chr(13) & chr(10),aLabel);			k=k+18;		end;		printtext = INr.GigieneText6;    preparetext(printtext);    if(nonblank(printtext))then begin			addtexttoarea("A20," & k &",0,a,1,1,N,\"" & printtext & "\"" & chr(13) & chr(10),aLabel);			k=k+18;		end;		printtext = INr.GigieneText7;    preparetext(printtext);    if(nonblank(printtext))then begin			addtexttoarea("A20," & k &",0,a,1,1,N,\"" & printtext & "\"" & chr(13) & chr(10),aLabel);			k=k+18;		end;		printtext = INr.GigieneText8;    preparetext(printtext);    if(nonblank(printtext))then begin			addtexttoarea("A20," & k &",0,a,1,1,N,\"" & printtext & "\"" & chr(13) & chr(10),aLabel);			k=k+18;		end;		printtext = INr.GigieneText9;    preparetext(printtext);    if(nonblank(printtext))then begin			addtexttoarea("A20," & k &",0,a,1,1,N,\"" & printtext & "\"" & chr(13) & chr(10),aLabel);			k=k+18;		end;		printtext = INr.GigieneText10;    preparetext(printtext);    if(nonblank(printtext))then begin			addtexttoarea("A20," & k &",0,a,1,1,N,\"" & printtext & "\"" & chr(13) & chr(10),aLabel);			k=k+18;		end;		printtext = INr.GigieneText11;    preparetext(printtext);    if(nonblank(printtext))then begin			addtexttoarea("A20," & k &",0,a,1,1,N,\"" & printtext & "\"" & chr(13) & chr(10),aLabel);			k=k+18;		end;		printtext = INr.GigieneText12;    preparetext(printtext);    if(nonblank(printtext))then begin			addtexttoarea("A20," & k &",0,a,1,1,N,\"" & printtext & "\"" & chr(13) & chr(10),aLabel);			k=k+18;		end;		printtext = INr.GigieneText13;    preparetext(printtext);    if(nonblank(printtext))then begin			addtexttoarea("A20," & k &",0,a,1,1,N,\"" & printtext & "\"" & chr(13) & chr(10),aLabel);			k=k+18;		end;		printtext = INr.GigieneText14;    preparetext(printtext);    if(nonblank(printtext))then begin			addtexttoarea("A20," & k &",0,a,1,1,N,\"" & printtext & "\"" & chr(13) & chr(10),aLabel);			k=k+18;		end;		printtext = INr.GigieneText15;    preparetext(printtext);    if(nonblank(printtext))then begin			addtexttoarea("A20," & k &",0,a,1,1,N,\"" & printtext & "\"" & chr(13) & chr(10),aLabel);			k=k+18;		end;		printtext = INr.GigieneText16;    preparetext(printtext);    if(nonblank(printtext))then begin			addtexttoarea("A20," & k &",0,a,1,1,N,\"" & printtext & "\"" & chr(13) & chr(10),aLabel);			k=k+18;		end;		printtext = INr.GigieneText17;    preparetext(printtext);    if(nonblank(printtext))then begin			addtexttoarea("A20," & k &",0,a,1,1,N,\"" & printtext & "\"" & chr(13) & chr(10),aLabel);			k=k+18;		end;		printtext = INr.GigieneText18;    preparetext(printtext);    if(nonblank(printtext))then begin			addtexttoarea("A20," & k &",0,a,1,1,N,\"" & printtext & "\"" & chr(13) & chr(10),aLabel);			k=k+18;		end;		printtext = INr.GigieneText19;    preparetext(printtext);    if(nonblank(printtext))then begin			addtexttoarea("A20," & k &",0,a,1,1,N,\"" & printtext & "\"" & chr(13) & chr(10),aLabel);			k=k+18;		end;		printtext = INr.GigieneText20;    preparetext(printtext);    if(nonblank(printtext))then begin			addtexttoarea("A20," & k &",0,a,1,1,N,\"" & printtext & "\"" & chr(13) & chr(10),aLabel);			k=k+18;		end;        /*for(i=0;i<mtrw;i=i+1)begin// Edit ************************** Friday, 17 October 2014 11:07:17      matrowget(GGr,i,GGrw);			printtext = GGrw.Str1;			preparetext(printtext);			addtexttoarea("A20," & k &",0,a,1,1,N,\"" & printtext & "\"" & chr(13) & chr(10),aLabel);			k=k+18;    end;*/        addtexttoarea("P" & RepSpec.flags[1] & chr(13) & chr(10),aLabel);    addtexttoarea(chr(13) & chr(10),aLabel);             CreateFile("ZebraPrint.epl");  closefile;  SetExportCodepage("CP1251");  WriteAreaToFile(aLabel,"ZebraPrint.epl",0);  millisleep(50);  if (WindowsMode==1) then begin    RunProgram("c:\\windows\\system32\\cmd.exe","/C \"" & "copy " & "ZebraPrint.epl" & " \\\\" & ZPb.ParamStr1 & "\\" & printername & "\"");  end;  if (WindowsMode==0) then begin    RunProgram("/usr/bin/lp","-d " & printername & " -o raw ZebraPrint.epl");  end;  return;end;global procedure ZebraFont()begin  record LocalMachineBlock LMb;  string 50 printername;  record ZebraPrinterBlock ZPb;     blockload(ZPb);  printername = LMb.DefPrinter;    if (WindowsMode==1) then begin    RunProgram("c:\\windows\\system32\\cmd.exe","/C \"" & "copy " & "arial_6.bin" & " \\\\" & ZPb.ParamStr1 & "\\" & printername & "\"");  end;  if (WindowsMode==0) then begin    RunProgram("/usr/bin/lp","-d " & printername & " -o raw arial_6.bin");  end;  return;end;global  //Edit***************************Sasha2,16:00 26.10.2015 {procedure ZebraLogo()begin  record LocalMachineBlock LMb;  string 50 printername;  record ZebraPrinterBlock ZPb;    blockload(ZPb);  printername = ZPb.PrinterName;    if (WindowsMode==1) then begin    if (blank(ZPb.ParamStr1) or blank(printername)) then begin      MessageBox(0,"Zebra settings are empty");    end else begin      RunProgram("c:\\windows\\system32\\cmd.exe","/C \"" & "copy " & "zebhead.txt + TECZNACK.pcx" & " \\\\" & ZPb.ParamStr1 & "\\" & printername & "\"");      /*millisleep(1000);      RunProgram("c:\\windows\\system32\\cmd.exe","/C \"" & "copy " & "zebhead.txt + TECZNACK.pcx" & " \\\\" & ZPb.ParamStr1 & "\\" & printername & "\"");*/    end;      end;  if (WindowsMode==0) then begin    if (blank(printername)) then begin      MessageBox(0,"Zebra settings are empty");    end else begin      RunProgram("/usr/bin/lp","-d " & printername & " -o raw zebhead1.txt");    end;      end;  return;end; //Edit***************************Sasha2,16:00 26.10.2015 }global procedure PrintPUZebra()begininteger wn;record RcVc RepSpec;  wn = CurWindow;  deselectwindow(wn,true);  GetWindowRecord(wn,RepSpec);    switch(RepSpec.flags[3])begin        case 0:PrintPU_Zebra(RepSpec);    case 1:PrintPU_ZebraBig(RepSpec);      end;return;end;function Boolean MyPrintLabelDialogTClassflagsEFAfter(Integer wn,Integer rownr,Integer changed)BEGINinteger i,mtrw;record RcVc RepSpec;  getwindowrecord(wn,RepSpec);  if(RepSpec.flags[0]!=1)then begin    RepSpec.flags[0]=1;    PutWindowRecord(wn,RepSpec);  end;    return;end;globalfunction Boolean MyPrintLabelDialogTClassAfterEditField(Integer wn,string fieldname,Integer fn, Integer rownr,Integer changed)BEGIN  Boolean res;      switch (fieldname) begin    case "flags[1]":MyPrintLabelDialogTClassflagsEFAfter(wn,rownr,changed);                  case "flags[2]":MyPrintLabelDialogTClassflagsEFAfter(wn,rownr,changed);  end;  MyPrintLabelDialogTClassAfterEditField = res;  RETURN;END;global procedure PrintPUZebraDsm()beginrecord RcVc RepSpec;record PUVc PUr;integer mtrw,i,wn;wn = curwindow;Getwindowrecord(wn,PUr);mtrw = matrowcnt(PUr);recordNew(RepSpec);RepSpec.long1 = PUr.SerNr;RepSpec.flags[0]=0;RepSpec.flags[1]=1;RepSpec.flags[2]=mtrw;RepSpec.flags[3]=0;OpenWindow("MyPrintLabelDialogTClass",1,0,"","",RepSpec);return;end;function Boolean GigieneLabelDialogTClassflagsEFAfter(Integer wn,Integer rownr,Integer changed)BEGINinteger i,mtrw;record RcVc RepSpec;  getwindowrecord(wn,RepSpec);  if(RepSpec.flags[0]!=1)then begin    RepSpec.flags[0]=1;    PutWindowRecord(wn,RepSpec);  end;return;end;globalfunction Boolean GigieneLabelDialogTClassAfterEditField(Integer wn,string fieldname,Integer fn, Integer rownr,Integer changed)BEGIN  Boolean res;      switch (fieldname) begin    case "flags[1]":GigieneLabelDialogTClassflagsEFAfter(wn,rownr,changed);                end;  GigieneLabelDialogTClassAfterEditField = res;  RETURN;END;global procedure GigieneTextZebraPrintDsm()beginrecord RcVc RepSpec;record PUVc PUr;integer mtrw,i,wn;record GigieneTextVc GGr;wn = curwindow;Getwindowrecord(wn,GGr);recordNew(RepSpec);RepSpec.f1 = GGr.ArtCode;RepSpec.flags[1]=1;OpenWindow("GigieneLabelDialogTClass",1,0,"","",RepSpec);return;end;global procedure ExportDocToFileDsm()begin	record DocVc Docr;	integer wn;	area arec;		wn = curwindow;	getwindowrecord(wn,Docr);		addrecordtoarea(Docr,"DocVc",arec);	createfile("/Users/Lada/TemDoc.txt");	writeareatofile(arec,"/Users/Lada/TemDoc.txt",0);	return;end;global procedure ImportDocFromFileDsm()begin	record DocVc Docr;	integer wn;	longint l;	area arec;		wn = curwindow;	addfiletoarea("/Users/Lada/TemDoc.txt",arec,0);		l = GetRecordFromArea(Docr,"DocVc",l,arec);	putwindowrecord(wn,Docr);	return;end;global updating procedure FillINFromGigieneMn()begin	record GigieneTextVc GGr;  row GigieneTextVc GGrw;  record INVc INr;  integer mtrw,i,k;      GGr.ArtCode = "";  while(loopmain(GGr,1,true))begin  	mtrw = matrowcnt(GGr);  	k=0;  	  	if(mtrw>0)then begin  		INr.Code = GGr.ArtCode;  		if(readfirstmain(INr,1,true))then begin  			For(i=0;i<mtrw;i=i+1) begin	  			matrowget(GGr,i,GGrw);	  			if(nonblank(GGrw.Str1))then begin	  				k=k+1;	  				switch(k)begin	  					case 1:INr.GigieneText1 = GGrw.Str1;	  					case 2:INr.GigieneText2 = GGrw.Str1;	  					case 3:INr.GigieneText3 = GGrw.Str1;	  					case 4:INr.GigieneText4 = GGrw.Str1;	  					case 5:INr.GigieneText5 = GGrw.Str1;	  					case 6:INr.GigieneText6 = GGrw.Str1;	  					case 7:INr.GigieneText7 = GGrw.Str1;	  					case 8:INr.GigieneText8 = GGrw.Str1;	  					case 9:INr.GigieneText9 = GGrw.Str1;	  					case 10:INr.GigieneText10 = GGrw.Str1;	  					case 11:INr.GigieneText11 = GGrw.Str1;	  					case 12:INr.GigieneText12 = GGrw.Str1;	  					case 13:INr.GigieneText13 = GGrw.Str1;	  					case 14:INr.GigieneText14 = GGrw.Str1;	  					case 15:INr.GigieneText15 = GGrw.Str1;	  					case 16:INr.GigieneText16 = GGrw.Str1;	  					case 17:INr.GigieneText17 = GGrw.Str1;	  					case 18:INr.GigieneText18 = GGrw.Str1;	  					case 19:INr.GigieneText19 = GGrw.Str1;	  					case 20:INr.GigieneText20 = GGrw.Str1;	  				end;	  			end;				end;				if(k>0)then begin					RecordStore(INr,true);				end;   			  		end;  		  	end;  end;return;end;global procedure ExportMySettingsDsm()begin	record CompaniesBlock CBb;	area exp;		blockload(CBb);		createfile("set.txt");	closefile;	openexportfile("set.txt",true);	blockexport("CompaniesBlock");	closefile;		createfile("setLoc.txt");	closefile;	openexportfile("setLoc.txt",true);	blockexport("LocalMachineBlock");	closefile;		createfile("setLocalLoginOptBlock.txt");	closefile;	openexportfile("setLocalLoginOptBlock.txt",true);	blockexport("LocalLoginOptBlock");	closefile;		/*addrecordtoarea(CBb,"CompaniesBlock",exp);	writeareatofile(exp,"set.txt",false);*/return;end;globalprocedure DblItemHist(string dblstr,string l,Integer currepwn)begin  record ItemHistVc IHr;    IHr.SerNr = dblstr;  if(readfirstmain(IHr,1,true))then begin  	OpenWindow("ItemHistDClass",1,0,"","",IHr);  end;      return;end;